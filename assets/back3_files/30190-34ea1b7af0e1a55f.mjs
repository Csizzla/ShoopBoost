"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[30190],{867013:(t,e,i)=>{i.d(e,{n:()=>s});let s=20},263032:(t,e,i)=>{i.d(e,{YS:()=>o,eF:()=>u,m_:()=>a});var s=i(934378),n=i(976731),r=i(953565);function a(t,e,i,n,a){let o=new URLSearchParams,u=e.reduce((t,e)=>{if(null!=e){let i=function(t){let e;try{e=decodeURIComponent(t)}catch(i){e=t}e.startsWith("http")?e.startsWith("http://")&&(e=e.replace("http://","https://")):e="https://"+e;try{return new URL(e).origin}catch(s){let i=e.match(/^(https?:\/\/[^\/]+)(\/|$)/);if(i&&i.length>1)return i[1];return t}}(e);return t.add(i)}return t},new Set);o.append(s.NR.SOURCE_EVENT_ID,t??"0"),o.append(s.NR.DESTINATION,JSON.stringify([...u])),o.append(s.NR.EXPIRY,i?s.uV:s.ug),o.append(s.NR.PRIORITY,i?s.NR.CLICK_PRIORITY:s.NR.VIEW_PRIORITY),a&&o.append(s.NR.ADVERTISER_ID,a),n&&o.append(s.NR.CAMPAIGN_ID,n),o.append(s.NR.SOURCE_EVENT_TYPE,i?s.bC:s.Cu);try{let{hostname:t}=new URL(window.location.href);"www.pinterest.com"!==t&&o.append(s.NR.HOSTNAME,t)}catch(t){(0,r.nP)("webapp.arapi.generateARASourceEventURL",{sampleRate:.1,tags:{status:"failed",href:window&&window.location&&window.location.href}})}return"https://www.pinterest.com/attribution_source/?"+o.toString()}async function o(t,e,i,s,o,u,h,l,d){let c;let{appType:p,osType:b}=u||{},v="",m="";if(["Pin","pinImpressions"].includes(t)&&e&&(s||l||d)){(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"start",appType:p,osType:b}});try{if(!window.document.featurePolicy?.allowsFeature("attribution-reporting")){(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"skipped",message:"attribution-reporting is not enabled",appType:p,osType:b}});return}v=a(i,[s,l,d],!1,o,h);try{m=new URL(window.location.href).hostname}catch(t){(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"hostname_parse_failed",href:window&&window.location&&window.location.href}})}if(m&&"www.pinterest.com"!==m)document.createElement("img").setAttribute("attributionsrc",v),(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"international",appType:p,osType:b,hostname:m}});else if(!(c=await window.fetch(v,{keepalive:!0,attributionReporting:{eventSourceEligible:!0,triggerEligible:!1}})).ok)throw Error("server request failed.");(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"success",appType:p,osType:b}})}catch(t){(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"failed",error:(0,n.Z)(t,"name"),message:(0,n.Z)(t,"message"),appType:p,osType:b,hostname:m,responseStatus:c&&c.status}})}}else(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"missing_param",appType:p,osType:b}})}function u(t){if(t){let e=t.toLowerCase();if(e.includes("windows"))return"windows xp"===e?1:"windows vista"===e?2:"windows 7"===e?3:"windows 8"===e?4:12;if(e.includes("mac os"))return 5;if(e.includes("android"))return 7;if(e.includes("ios"))return 6;if(e.includes("ubuntu"))return 8;if(e.includes("chromium os"))return 13}return 0}},86785:(t,e,i)=>{i.d(e,{G6:()=>r,i7:()=>a,oi:()=>s,u$:()=>n,un:()=>u,vU:()=>o,w1:()=>h});let s=Object.freeze({OTHER:0,CHROME:1,SAFARI:2,IE:3,FIREFOX:4,OPERA:5,EDGE:6}),n=t=>t?t.includes("Chrome")?s.CHROME:t.includes("Safari")?s.SAFARI:t.includes("Firefox")?s.FIREFOX:t.includes("Opera")?s.OPERA:t.includes("IE")?s.IE:t.includes("Edge")?s.EDGE:s.OTHER:s.OTHER;function r(t){return n(t)===s.SAFARI}function a(t){return n(t)===s.CHROME}function o(t){return n(t)===s.FIREFOX}function u(t){return n(t)===s.EDGE}function h(t){return n(t)===s.IE}},307772:(t,e,i)=>{function s(t,e,i){var s;return(e="symbol"==typeof(s=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?s:String(s))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{Z3:()=>d,LU:()=>c,ZP:()=>p});let n=window.location.search.includes("debug_impressions=1")||document.cookie&&document.cookie.indexOf("debug_impressions=1")>-1,r={paused:"Pause",resumed:"Resume",stopped:"Flush",enter:"Enter viewport",exit:"Exit viewport"},a={},o={background:"#FF8A8A",transform:"scale(.98)"},u={init:t=>({transform:`scale(${a[t]?.8:.99})`,transition:"transform .2s ease-in-out",background:"#8E8E8E"}),[r.enter]:{background:"#A0DCC8",transform:"scale(.99)"},[r.exit]:o,[r.stopped]:o,[r.paused]:o,[r.resumed]:{background:"#0FA573",transform:"scale(.99)"}};class h{constructor(t){s(this,"setMutationObserver",t=>(this.mutationObserver=t,this)),s(this,"startMutationObserver",t=>{this.mutationObserver&&this.mutationObserver.observe(this.node,t)}),s(this,"stopMutationObserver",()=>{this.mutationObserver&&this.mutationObserver.disconnect()}),s(this,"handleIntersectionChange",t=>{let e=t.intersectionRatio>0||t.isIntersecting,i=Date.now();t.intersectionRatio>0&&!this.visibleEvents.has(1)&&this.visibleEvents.set(1,i),t.intersectionRatio>.5?this.visibleEvents.has(50)||this.visibleEvents.set(50,i):this.visibleEvents.has(50)&&!this.hiddenEvents.has(50)&&this.hiddenEvents.set(50,i),t.intersectionRatio>.8?this.visibleEvents.has(80)||this.visibleEvents.set(80,i):this.visibleEvents.has(80)&&!this.hiddenEvents.has(80)&&this.hiddenEvents.set(80,i),1!==t.intersectionRatio||this.visibleEvents.has(2)||this.visibleEvents.set(2,i),t.boundingClientRect.top<=143&&this.visibleEvents.has(1)&&!this.hiddenEvents.has(1)&&this.hiddenEvents.set(1,i),t.boundingClientRect.bottom<=143&&this.visibleEvents.has(2)&&!this.hiddenEvents.has(2)&&this.hiddenEvents.set(2,i),e&&!this.inViewport?(this.startTime=i,this._debug(r.enter,{startTime:i,node:this.node}),this.enterCallbacks.forEach(t=>t())):!e&&this.inViewport&&(this._debug(r.exit,!0),this.exitCallbacks.forEach(t=>t(this.toJSON()))),this.inViewport=e}),this.enterCallbacks=[],this.exitCallbacks=[],this.inViewport=!1,this.node=t,this.startTime=0,this.debugId="",this.visibleEvents=new Map,this.hiddenEvents=new Map}onEnterViewport(t){return this.enterCallbacks.push(t),this}onExitViewport(t){return this.exitCallbacks.push(t),this}setDebugId(t){return this.debugId=t,n&&Object.assign(this.node.style,u.init(t)),this}pause(){return this.inViewport&&(this._debug(r.paused,!0),this.exitCallbacks.forEach(t=>t(this.toJSON()))),this}resume(){if(this.inViewport){let t=Date.now();this._debug(r.resumed,{startTime:t}),this.startTime=t}return this}stop(t){return this.inViewport&&(this._debug(r.stopped,!0),this.exitCallbacks.forEach(e=>e(this.toJSON(t)))),this}toJSON(t=""){return{startTime:1e6*this.startTime,endTime:1e6*Date.now(),forcedExit:t,hiddenEvents:this.hiddenEvents,visibleEvents:this.visibleEvents}}toDebugJSON(){return{pinID:this.debugId,startTime:this.startTime,endTime:Date.now(),duration:`${(Date.now()-this.startTime)/1e3} seconds`}}_debug(t,e){if(n)switch(window.console.log(`ðŸ“Œ ${t} -- ${this.debugId}`),!0===e&&window.console.log(this.toDebugJSON()),"object"==typeof e&&window.console.log(e),u[t]&&Object.assign(this.node.style,u[t]),t){case r.flushed:case r.paused:case r.exit:a[this.debugId]=!0}}}function l(t,e,i){var s;return(e="symbol"==typeof(s=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?s:String(s))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let d=!0,c=!1;class p{constructor(){l(this,"_delegateChange",t=>{t.forEach(t=>{let e=this.activeImpressions.get(t.target);e&&e.handleIntersectionChange(t)})}),l(this,"_handleMutations",(t,e)=>{let i=this.mutationObservers.get(e);i&&i.offsetHeight<1&&i&&this.stop(i,"removed")}),this.activeImpressions=new Map,this.mutationObservers=new Map,this.bottomHeight=0,this.bottomObstructions=new Set,this.pausePriority=c,this.observer=new window.IntersectionObserver(this._delegateChange),window.Cypress&&!window.activeImpressions&&(window.activeImpressions=new Map),this.paused=!1,this.topHeight=0,this.topObstructions=new Set,this.inExperiment=!1}setExperimentStatus(t){this.inExperiment!==t&&(this.inExperiment=t)}stop(t,e=""){let i=this.activeImpressions.get(t);i&&(i.stop(e),this.mutationObservers.delete(i.mutationObserver),i.stopMutationObserver(),this.activeImpressions.delete(t),window.activeImpressions?.delete(t),this.observer.unobserve(t))}start(t){let e=this.activeImpressions.get(t);return e||(e=new h(t),this.activeImpressions.set(t,e),window.activeImpressions?.set(t,e),this.observer.observe(t),e.setMutationObserver(new window.MutationObserver((t,e)=>this._handleMutations(t,e))),this.mutationObservers.set(e.mutationObserver,t),e.startMutationObserver({subtree:!0,attributes:!0,attributeFilter:["style"]})),e}pause(t=d){this.paused||(Array.from(this.activeImpressions.values()).forEach(t=>t.pause()),this.paused=!0,this.pausePriority!==c||(this.pausePriority=t))}resume(t=d){(t!==c||this.pausePriority!==d)&&this.paused&&(Array.from(this.activeImpressions.values()).forEach(t=>t.resume()),this.paused=!1,this.pausePriority=c)}addObstruction(t,e){"top"===t?this.topObstructions.add(e):"bottom"===t&&this.bottomObstructions.add(e),this._calculateRootMargins()}removeObstruction(t,e){"top"===t?this.topObstructions.delete(e):"bottom"===t&&this.bottomObstructions.delete(e),this._calculateRootMargins()}updateObstructions(){this._calculateRootMargins()}_calculateRootMargins(){let t=Array.from(this.topObstructions).reduce((t,e)=>{let{bottom:i}=e.getBoundingClientRect();return i>t?i:t},0),e=window.innerHeight-Array.from(this.bottomObstructions).reduce((t,e)=>{let{top:i}=e.getBoundingClientRect();return i<t?i:t},window.innerHeight);if(t!==this.topHeight||e!==this.bottomHeight){let i={rootMargin:`${-t}px 0px ${-e}px`,threshold:[0,.5,.8,1]};this.observer.disconnect(),this.observer=new window.IntersectionObserver(this._delegateChange,i),Array.from(this.activeImpressions.values()).forEach(t=>this.observer.observe(t.node)),this.topHeight=t,this.bottomHeight=e}}}},30378:(t,e,i)=>{i.d(e,{Z:()=>s});let s=new(i(307772)).ZP},369708:(t,e,i)=>{i.d(e,{W:()=>l,r:()=>h});var s=i(667294),n=i(214877),r=i(342513),a=i(340523),o=i(785893);let{Provider:u,useHook:h}=(0,r.Z)("VideoPlayer");function l({children:t}){let{logContextEvent:e,logImpression:i}=(0,n.v)(),{checkExperiment:r}=(0,a.F)(),[h,l]=(0,s.useState)(!1),[d,c]=(0,s.useState)([]),[p,b]=(0,s.useState)([]),[v,m]=(0,s.useState)({}),w=r("web_ads_mrc_video_impression").anyEnabled,f=t=>{m(e=>({...e,[t]:!0}))},g=(0,s.useCallback)(t=>{if(18===t.event_type&&t.event_data?.pinImpressions?.length){let{isNativeVideoAndWatchable:e}=t.event_data.pinImpressions[0],i=(t.aux_data?.commerce_data||"").includes("story_pin_id");w&&(e||i)&&c(e=>[...e,t].slice(-1e3))}},[w]),E=(0,s.useCallback)(t=>{18===t.eventType&&w&&b(e=>[...e,t].slice(-1e3))},[w]),O=t=>{let{time:e}=t.event_data.pinImpressions[0];return{...t,event_data:{...t.event_data,pinImpressions:[{...t.event_data.pinImpressions[0],isMrcBtr:!0,endTime:e,renderDuration:0}]}}},R=t=>{if(t.eventData){let{time:e}=t.eventData;return{...t,eventData:{...t.eventData,isMrcBtr:!0,endTime:e??0}}}return null};(0,s.useEffect)(()=>{let t=d.filter(t=>{let{pinIdStr:i}=t.event_data.pinImpressions[0];return!v[i]||!w||(e(O(t)),!1)});t.length!==d.length&&c(t)},[d,w,e,v]),(0,s.useEffect)(()=>{let t=p.filter(t=>{let e=t.eventData?.pinIdStr;if(!e)return!1;if(v[e]&&w){let e=R(t);return e&&i(e),!1}return!0});t.length!==p.length&&b(t)},[p,w,i,v]);let I=(0,s.useMemo)(()=>({captionsEnabled:h,logMrcVideoAdImpressionOnPlay:E,logMrcVideoAdEventOnPlay:g,setCaptionsEnabled:l,setVideoPlayed:f,videosPlayed:v}),[h,g,E,v]);return(0,o.jsx)(u,{value:I,children:t})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/30190-34ea1b7af0e1a55f.mjs.map